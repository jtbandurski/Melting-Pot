{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.42188535183668, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0005000000000000001, "total_loss": 2.864676734432578, "policy_loss": -0.031722516258014366, "vf_loss": 2.8925415131729095, "vf_explained_var": 0.3334213525056839, "kl": 0.09522357372919894, "entropy": 1.5186958476901053, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 80.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.58591351658106, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0005000000000000001, "total_loss": 1.7667374505195768, "policy_loss": 0.12360631553601706, "vf_loss": 1.6461148979142308, "vf_explained_var": 0.32538208141922953, "kl": 0.05529877469989898, "entropy": 1.404350148141384, "entropy_coeff": 0.009999999999999998}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 80.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "sampler_results": {"episode_reward_max": 40.0, "episode_reward_min": 35.0, "episode_reward_mean": 37.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 18.0, "agent_1": 17.0}, "policy_reward_max": {"agent_0": 22.0, "agent_1": 18.0}, "policy_reward_mean": {"agent_0": 19.666666666666668, "agent_1": 17.333333333333332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0], "episode_lengths": [500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0], "policy_agent_1_reward": [17.0, 17.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6385078517955005, "mean_inference_ms": 8.927610310275487, "mean_action_processing_ms": 0.4475508616339073, "mean_env_wait_ms": 0.8546245970156375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.010136763254801432, "ViewRequirementAgentConnector_ms": 0.33447742462158203}}, "episode_reward_max": 40.0, "episode_reward_min": 35.0, "episode_reward_mean": 37.0, "episode_len_mean": 500.0, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 18.0, "agent_1": 17.0}, "policy_reward_max": {"agent_0": 22.0, "agent_1": 18.0}, "policy_reward_mean": {"agent_0": 19.666666666666668, "agent_1": 17.333333333333332}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0], "episode_lengths": [500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0], "policy_agent_1_reward": [17.0, 17.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6385078517955005, "mean_inference_ms": 8.927610310275487, "mean_action_processing_ms": 0.4475508616339073, "mean_env_wait_ms": 0.8546245970156375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.010136763254801432, "ViewRequirementAgentConnector_ms": 0.33447742462158203}, "num_healthy_workers": 3, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_env_steps_sampled_this_iter": 2048, "num_env_steps_trained_this_iter": 2048, "num_env_steps_sampled_throughput_per_sec": 153.39052227924122, "num_env_steps_trained_throughput_per_sec": 153.39052227924122, "timesteps_total": 2048, "num_steps_trained_this_iter": 2048, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 13351.488, "sample_time_ms": 8390.229, "learn_time_ms": 4952.27, "learn_throughput": 413.548, "synch_weights_time_ms": 7.821}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "done": false, "episodes_total": 3, "training_iteration": 1, "trial_id": "e9e7e_00000", "date": "2024-04-12_21-52-36", "timestamp": 1712958756, "time_this_iter_s": 13.363240718841553, "time_total_s": 13.363240718841553, "pid": 4750, "hostname": "ip-172-31-8-71", "node_ip": "172.31.8.71", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "meltingpot", "env_config": {"substrate": "commons_harvest__collective", "roles": ["default", "default"], "scaled": 8}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "relu", "conv_filters": [[16, [3, 3], 1], [32, [7, 7], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 128, "lstm_use_prev_action": true, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 7, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function get_experiment_config.<locals>.<lambda> at 0x7fd7f28c3010>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 123, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0005], [100000000000.0, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [100000000000.0, 0.001]], "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 4, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}], "agent_1": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3}, "time_since_restore": 13.363240718841553, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 73.58, "ram_util_percent": 20.675000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.85267194509506, "cur_kl_coeff": 0.3, "cur_lr": 0.0004999999815679999, "total_loss": 2.722232466377318, "policy_loss": -0.019925264187622815, "vf_loss": 2.753112761490047, "vf_explained_var": 0.19282643869519234, "kl": 0.015842681427133354, "entropy": 1.5707851022481918, "entropy_coeff": 0.00999999963136}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.125145173072816, "cur_kl_coeff": 0.3, "cur_lr": 0.0004999999815679999, "total_loss": 2.852256138622761, "policy_loss": -0.026569155184552072, "vf_loss": 2.8869579734280704, "vf_explained_var": 0.40461871959269047, "kl": 0.02115038390910076, "entropy": 1.4477795869112016, "entropy_coeff": 0.00999999963136}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "sampler_results": {"episode_reward_max": 41.0, "episode_reward_min": 35.0, "episode_reward_mean": 38.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 18.0, "agent_1": 17.0}, "policy_reward_max": {"agent_0": 22.0, "agent_1": 22.0}, "policy_reward_mean": {"agent_0": 19.333333333333332, "agent_1": 18.666666666666668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0], "episode_lengths": [500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5286106251031883, "mean_inference_ms": 8.378139465716192, "mean_action_processing_ms": 0.4198240436572997, "mean_env_wait_ms": 0.7635489356984585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00979304313659668, "ViewRequirementAgentConnector_ms": 0.311964750289917}}, "episode_reward_max": 41.0, "episode_reward_min": 35.0, "episode_reward_mean": 38.0, "episode_len_mean": 500.0, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 18.0, "agent_1": 17.0}, "policy_reward_max": {"agent_0": 22.0, "agent_1": 22.0}, "policy_reward_mean": {"agent_0": 19.333333333333332, "agent_1": 18.666666666666668}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0], "episode_lengths": [500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5286106251031883, "mean_inference_ms": 8.378139465716192, "mean_action_processing_ms": 0.4198240436572997, "mean_env_wait_ms": 0.7635489356984585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00979304313659668, "ViewRequirementAgentConnector_ms": 0.311964750289917}, "num_healthy_workers": 3, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_env_steps_sampled_this_iter": 2048, "num_env_steps_trained_this_iter": 2048, "num_env_steps_sampled_throughput_per_sec": 155.86168492881148, "num_env_steps_trained_throughput_per_sec": 155.86168492881148, "timesteps_total": 4096, "num_steps_trained_this_iter": 2048, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 13245.65, "sample_time_ms": 7478.051, "learn_time_ms": 5758.591, "learn_throughput": 355.643, "synch_weights_time_ms": 8.022}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "done": false, "episodes_total": 6, "training_iteration": 2, "trial_id": "e9e7e_00000", "date": "2024-04-12_21-52-53", "timestamp": 1712958773, "time_this_iter_s": 13.149371862411499, "time_total_s": 26.51261258125305, "pid": 4750, "hostname": "ip-172-31-8-71", "node_ip": "172.31.8.71", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "meltingpot", "env_config": {"substrate": "commons_harvest__collective", "roles": ["default", "default"], "scaled": 8}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "relu", "conv_filters": [[16, [3, 3], 1], [32, [7, 7], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 128, "lstm_use_prev_action": true, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 7, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function get_experiment_config.<locals>.<lambda> at 0x7fd7f292f1c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 123, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0005], [100000000000.0, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [100000000000.0, 0.001]], "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 4, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}], "agent_1": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3}, "time_since_restore": 26.51261258125305, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 44.90833333333333, "ram_util_percent": 24.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.277913228203268, "cur_kl_coeff": 0.3, "cur_lr": 0.000499999963136, "total_loss": 3.2077498474541835, "policy_loss": -0.009823078837464838, "vf_loss": 3.22869192729978, "vf_explained_var": -0.06952976409126731, "kl": 0.014727173611002866, "entropy": 1.553710619141074, "entropy_coeff": 0.00999999926272}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 84.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.515164777811837, "cur_kl_coeff": 0.4500000000000002, "cur_lr": 0.000499999963136, "total_loss": 3.9976694540065876, "policy_loss": 0.029142360761761667, "vf_loss": 3.9691686051733353, "vf_explained_var": -0.20025737951783573, "kl": 0.030032876722216863, "entropy": 1.4156328797340394, "entropy_coeff": 0.00999999926272}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 84.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "sampler_results": {"episode_reward_max": 45.0, "episode_reward_min": 16.0, "episode_reward_mean": 36.083333333333336, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 12.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 27.0, "agent_1": 25.0}, "policy_reward_mean": {"agent_0": 18.083333333333332, "agent_1": 18.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4498762017012325, "mean_inference_ms": 7.926459955906033, "mean_action_processing_ms": 0.3959767189512659, "mean_env_wait_ms": 0.6869061767410579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008733073870340982, "ViewRequirementAgentConnector_ms": 0.2849121888478597}}, "episode_reward_max": 45.0, "episode_reward_min": 16.0, "episode_reward_mean": 36.083333333333336, "episode_len_mean": 500.0, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 12.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 27.0, "agent_1": 25.0}, "policy_reward_mean": {"agent_0": 18.083333333333332, "agent_1": 18.0}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4498762017012325, "mean_inference_ms": 7.926459955906033, "mean_action_processing_ms": 0.3959767189512659, "mean_env_wait_ms": 0.6869061767410579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008733073870340982, "ViewRequirementAgentConnector_ms": 0.2849121888478597}, "num_healthy_workers": 3, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_env_steps_sampled_this_iter": 2048, "num_env_steps_trained_this_iter": 2048, "num_env_steps_sampled_throughput_per_sec": 140.80048738648324, "num_env_steps_trained_throughput_per_sec": 140.80048738648324, "timesteps_total": 6144, "num_steps_trained_this_iter": 2048, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 13678.887, "sample_time_ms": 7214.135, "learn_time_ms": 6455.765, "learn_throughput": 317.236, "synch_weights_time_ms": 8.063}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "done": false, "episodes_total": 12, "training_iteration": 3, "trial_id": "e9e7e_00000", "date": "2024-04-12_21-53-08", "timestamp": 1712958788, "time_this_iter_s": 14.556005477905273, "time_total_s": 41.068618059158325, "pid": 4750, "hostname": "ip-172-31-8-71", "node_ip": "172.31.8.71", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "meltingpot", "env_config": {"substrate": "commons_harvest__collective", "roles": ["default", "default"], "scaled": 8}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "relu", "conv_filters": [[16, [3, 3], 1], [32, [7, 7], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 128, "lstm_use_prev_action": true, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 7, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function get_experiment_config.<locals>.<lambda> at 0x7fd7f292f6d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 123, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0005], [100000000000.0, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [100000000000.0, 0.001]], "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 4, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}], "agent_1": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3}, "time_since_restore": 41.068618059158325, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 47.404761904761905, "ram_util_percent": 24.557142857142864}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.957526570207932, "cur_kl_coeff": 0.3, "cur_lr": 0.000499999944704, "total_loss": 2.308565530794508, "policy_loss": -0.008805945488240789, "vf_loss": 2.328086306943613, "vf_explained_var": 0.2535592850516824, "kl": 0.015132659524234067, "entropy": 1.5254613455604105, "entropy_coeff": 0.00999999889408}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 575.5, "diff_num_grad_updates_vs_sampler_policy": 84.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.492677363227395, "cur_kl_coeff": 0.6749999999999998, "cur_lr": 0.000499999944704, "total_loss": 2.278455519150285, "policy_loss": -0.0011304469669566435, "vf_loss": 2.283603391971658, "vf_explained_var": -0.4101548002046697, "kl": 0.015241877652929734, "entropy": 1.4305655879132888, "entropy_coeff": 0.00999999889408}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 575.5, "diff_num_grad_updates_vs_sampler_policy": 84.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "sampler_results": {"episode_reward_max": 45.0, "episode_reward_min": 16.0, "episode_reward_mean": 34.8, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 12.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 27.0, "agent_1": 25.0}, "policy_reward_mean": {"agent_0": 18.0, "agent_1": 16.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0, 33.0, 26.0, 30.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0, 14.0, 16.0, 23.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0, 19.0, 10.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4265636319529083, "mean_inference_ms": 7.798037773230908, "mean_action_processing_ms": 0.3888838139418573, "mean_env_wait_ms": 0.6645104506922589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00879685084025065, "ViewRequirementAgentConnector_ms": 0.2860705057779948}}, "episode_reward_max": 45.0, "episode_reward_min": 16.0, "episode_reward_mean": 34.8, "episode_len_mean": 500.0, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 12.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 27.0, "agent_1": 25.0}, "policy_reward_mean": {"agent_0": 18.0, "agent_1": 16.8}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0, 33.0, 26.0, 30.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0, 14.0, 16.0, 23.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0, 19.0, 10.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4265636319529083, "mean_inference_ms": 7.798037773230908, "mean_action_processing_ms": 0.3888838139418573, "mean_env_wait_ms": 0.6645104506922589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00879685084025065, "ViewRequirementAgentConnector_ms": 0.2860705057779948}, "num_healthy_workers": 3, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_env_steps_sampled_this_iter": 2048, "num_env_steps_trained_this_iter": 2048, "num_env_steps_sampled_throughput_per_sec": 145.58277715854254, "num_env_steps_trained_throughput_per_sec": 145.58277715854254, "timesteps_total": 8192, "num_steps_trained_this_iter": 2048, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 13776.054, "sample_time_ms": 7049.63, "learn_time_ms": 6717.67, "learn_throughput": 304.868, "synch_weights_time_ms": 7.863}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "done": false, "episodes_total": 15, "training_iteration": 4, "trial_id": "e9e7e_00000", "date": "2024-04-12_21-53-22", "timestamp": 1712958802, "time_this_iter_s": 14.077468633651733, "time_total_s": 55.14608669281006, "pid": 4750, "hostname": "ip-172-31-8-71", "node_ip": "172.31.8.71", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "meltingpot", "env_config": {"substrate": "commons_harvest__collective", "roles": ["default", "default"], "scaled": 8}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "relu", "conv_filters": [[16, [3, 3], 1], [32, [7, 7], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 128, "lstm_use_prev_action": true, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 7, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function get_experiment_config.<locals>.<lambda> at 0x7fd7400e0790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 123, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0005], [100000000000.0, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [100000000000.0, 0.001]], "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 4, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}], "agent_1": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3}, "time_since_restore": 55.14608669281006, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 48.25000000000001, "ram_util_percent": 24.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.440723249491523, "cur_kl_coeff": 0.3, "cur_lr": 0.0004999999262720001, "total_loss": 2.394873015977004, "policy_loss": -0.006711170011583496, "vf_loss": 2.4131982217816748, "vf_explained_var": 0.19599852316519795, "kl": 0.010784746799229632, "entropy": 1.4849440525559818, "entropy_coeff": 0.009999998525440002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 745.5, "diff_num_grad_updates_vs_sampler_policy": 84.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.09612481173347, "cur_kl_coeff": 0.6749999999999998, "cur_lr": 0.0004999999262720001, "total_loss": 1.665923120234819, "policy_loss": -0.0013476951814749662, "vf_loss": 1.6698884868884787, "vf_explained_var": -0.17757517695426941, "kl": 0.017042694156207367, "entropy": 1.4121491439202252, "entropy_coeff": 0.009999998525440002}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 745.5, "diff_num_grad_updates_vs_sampler_policy": 84.5}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "sampler_results": {"episode_reward_max": 45.0, "episode_reward_min": 16.0, "episode_reward_mean": 34.44444444444444, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 12.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 27.0, "agent_1": 25.0}, "policy_reward_mean": {"agent_0": 18.22222222222222, "agent_1": 16.22222222222222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0, 33.0, 26.0, 30.0, 33.0, 21.0, 44.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0, 14.0, 16.0, 23.0, 15.0, 16.0, 27.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0, 19.0, 10.0, 7.0, 18.0, 5.0, 17.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4066456914491914, "mean_inference_ms": 7.69385422794148, "mean_action_processing_ms": 0.3832023115644662, "mean_env_wait_ms": 0.646783141385924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008790360556708442, "ViewRequirementAgentConnector_ms": 0.2894130018022325}}, "episode_reward_max": 45.0, "episode_reward_min": 16.0, "episode_reward_mean": 34.44444444444444, "episode_len_mean": 500.0, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 12.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 27.0, "agent_1": 25.0}, "policy_reward_mean": {"agent_0": 18.22222222222222, "agent_1": 16.22222222222222}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0, 33.0, 26.0, 30.0, 33.0, 21.0, 44.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0, 14.0, 16.0, 23.0, 15.0, 16.0, 27.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0, 19.0, 10.0, 7.0, 18.0, 5.0, 17.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4066456914491914, "mean_inference_ms": 7.69385422794148, "mean_action_processing_ms": 0.3832023115644662, "mean_env_wait_ms": 0.646783141385924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008790360556708442, "ViewRequirementAgentConnector_ms": 0.2894130018022325}, "num_healthy_workers": 3, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_env_steps_sampled_this_iter": 2048, "num_env_steps_trained_this_iter": 2048, "num_env_steps_sampled_throughput_per_sec": 146.17885631480706, "num_env_steps_trained_throughput_per_sec": 146.17885631480706, "timesteps_total": 10240, "num_steps_trained_this_iter": 2048, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 13822.882, "sample_time_ms": 6958.394, "learn_time_ms": 6855.829, "learn_throughput": 298.724, "synch_weights_time_ms": 7.78}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "done": false, "episodes_total": 18, "training_iteration": 5, "trial_id": "e9e7e_00000", "date": "2024-04-12_21-53-36", "timestamp": 1712958816, "time_this_iter_s": 14.020655155181885, "time_total_s": 69.16674184799194, "pid": 4750, "hostname": "ip-172-31-8-71", "node_ip": "172.31.8.71", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "meltingpot", "env_config": {"substrate": "commons_harvest__collective", "roles": ["default", "default"], "scaled": 8}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "relu", "conv_filters": [[16, [3, 3], 1], [32, [7, 7], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 128, "lstm_use_prev_action": true, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 7, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function get_experiment_config.<locals>.<lambda> at 0x7fd7400e1090>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 123, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0005], [100000000000.0, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [100000000000.0, 0.001]], "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 4, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}], "agent_1": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3}, "time_since_restore": 69.16674184799194, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 48.005, "ram_util_percent": 24.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.85327455997467, "cur_kl_coeff": 0.3, "cur_lr": 0.0004999999078400001, "total_loss": 4.211955227702856, "policy_loss": 0.034707513160537926, "vf_loss": 4.186733934283256, "vf_explained_var": -0.0357105441391468, "kl": 0.019389359202526622, "entropy": 1.5303050860762597, "entropy_coeff": 0.0099999981568}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 910.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.11092163473368, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0004999999078400001, "total_loss": 1.5700331088039092, "policy_loss": 0.02911416534334421, "vf_loss": 1.5474700359452982, "vf_explained_var": -0.04732827134430408, "kl": 0.011772203848067875, "entropy": 1.4497328959405422, "entropy_coeff": 0.0099999981568}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 910.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "sampler_results": {"episode_reward_max": 55.0, "episode_reward_min": 16.0, "episode_reward_mean": 33.625, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 4.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 27.0, "agent_1": 31.0}, "policy_reward_mean": {"agent_0": 17.416666666666668, "agent_1": 16.208333333333332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0, 33.0, 26.0, 30.0, 33.0, 21.0, 44.0, 27.0, 29.0, 38.0, 55.0, 21.0, 17.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0, 14.0, 16.0, 23.0, 15.0, 16.0, 27.0, 9.0, 22.0, 25.0, 24.0, 6.0, 4.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0, 19.0, 10.0, 7.0, 18.0, 5.0, 17.0, 18.0, 7.0, 13.0, 31.0, 15.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3788043095618001, "mean_inference_ms": 7.5488487748894535, "mean_action_processing_ms": 0.37477995055223284, "mean_env_wait_ms": 0.6210860270455059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008504589398701986, "ViewRequirementAgentConnector_ms": 0.28042346239089966}}, "episode_reward_max": 55.0, "episode_reward_min": 16.0, "episode_reward_mean": 33.625, "episode_len_mean": 500.0, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 4.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 27.0, "agent_1": 31.0}, "policy_reward_mean": {"agent_0": 17.416666666666668, "agent_1": 16.208333333333332}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0, 33.0, 26.0, 30.0, 33.0, 21.0, 44.0, 27.0, 29.0, 38.0, 55.0, 21.0, 17.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0, 14.0, 16.0, 23.0, 15.0, 16.0, 27.0, 9.0, 22.0, 25.0, 24.0, 6.0, 4.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0, 19.0, 10.0, 7.0, 18.0, 5.0, 17.0, 18.0, 7.0, 13.0, 31.0, 15.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3788043095618001, "mean_inference_ms": 7.5488487748894535, "mean_action_processing_ms": 0.37477995055223284, "mean_env_wait_ms": 0.6210860270455059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008504589398701986, "ViewRequirementAgentConnector_ms": 0.28042346239089966}, "num_healthy_workers": 3, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_env_steps_sampled_this_iter": 2048, "num_env_steps_trained_this_iter": 2048, "num_env_steps_sampled_throughput_per_sec": 148.03229617107328, "num_env_steps_trained_throughput_per_sec": 148.03229617107328, "timesteps_total": 12288, "num_steps_trained_this_iter": 2048, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 13824.865, "sample_time_ms": 6902.026, "learn_time_ms": 6914.292, "learn_throughput": 296.198, "synch_weights_time_ms": 7.687}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "done": false, "episodes_total": 24, "training_iteration": 6, "trial_id": "e9e7e_00000", "date": "2024-04-12_21-53-50", "timestamp": 1712958830, "time_this_iter_s": 13.845245838165283, "time_total_s": 83.01198768615723, "pid": 4750, "hostname": "ip-172-31-8-71", "node_ip": "172.31.8.71", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "meltingpot", "env_config": {"substrate": "commons_harvest__collective", "roles": ["default", "default"], "scaled": 8}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "relu", "conv_filters": [[16, [3, 3], 1], [32, [7, 7], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 128, "lstm_use_prev_action": true, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 7, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function get_experiment_config.<locals>.<lambda> at 0x7fd7400e1fc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 123, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0005], [100000000000.0, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [100000000000.0, 0.001]], "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 4, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}], "agent_1": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3}, "time_since_restore": 83.01198768615723, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 48.739999999999995, "ram_util_percent": 24.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.44103846848011, "cur_kl_coeff": 0.3, "cur_lr": 0.0004999998894079999, "total_loss": 2.352561501786113, "policy_loss": -0.009717506403103471, "vf_loss": 2.3728809650987386, "vf_explained_var": 0.054145925864577296, "kl": 0.013017308122144827, "entropy": 1.4507130421698093, "entropy_coeff": 0.009999997788160003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1070.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.403446735441683, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0004999998894079999, "total_loss": 1.1844962709292304, "policy_loss": -0.061394852219382304, "vf_loss": 1.2531412247917615, "vf_explained_var": -0.22880205921828747, "kl": 0.010985268377028876, "entropy": 1.466513028740883, "entropy_coeff": 0.009999997788160003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1070.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "sampler_results": {"episode_reward_max": 55.0, "episode_reward_min": 16.0, "episode_reward_mean": 34.592592592592595, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 4.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 27.0, "agent_1": 31.0}, "policy_reward_mean": {"agent_0": 17.814814814814813, "agent_1": 16.77777777777778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0, 33.0, 26.0, 30.0, 33.0, 21.0, 44.0, 27.0, 29.0, 38.0, 55.0, 21.0, 17.0, 33.0, 52.0, 42.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0, 14.0, 16.0, 23.0, 15.0, 16.0, 27.0, 9.0, 22.0, 25.0, 24.0, 6.0, 4.0, 14.0, 22.0, 27.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0, 19.0, 10.0, 7.0, 18.0, 5.0, 17.0, 18.0, 7.0, 13.0, 31.0, 15.0, 13.0, 19.0, 30.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3682524518456534, "mean_inference_ms": 7.494148830840449, "mean_action_processing_ms": 0.37166348395909427, "mean_env_wait_ms": 0.6115073924755215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008496531733760127, "ViewRequirementAgentConnector_ms": 0.28158382133201315}}, "episode_reward_max": 55.0, "episode_reward_min": 16.0, "episode_reward_mean": 34.592592592592595, "episode_len_mean": 500.0, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 4.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 27.0, "agent_1": 31.0}, "policy_reward_mean": {"agent_0": 17.814814814814813, "agent_1": 16.77777777777778}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0, 33.0, 26.0, 30.0, 33.0, 21.0, 44.0, 27.0, 29.0, 38.0, 55.0, 21.0, 17.0, 33.0, 52.0, 42.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0, 14.0, 16.0, 23.0, 15.0, 16.0, 27.0, 9.0, 22.0, 25.0, 24.0, 6.0, 4.0, 14.0, 22.0, 27.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0, 19.0, 10.0, 7.0, 18.0, 5.0, 17.0, 18.0, 7.0, 13.0, 31.0, 15.0, 13.0, 19.0, 30.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3682524518456534, "mean_inference_ms": 7.494148830840449, "mean_action_processing_ms": 0.37166348395909427, "mean_env_wait_ms": 0.6115073924755215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008496531733760127, "ViewRequirementAgentConnector_ms": 0.28158382133201315}, "num_healthy_workers": 3, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_env_steps_sampled_this_iter": 2048, "num_env_steps_trained_this_iter": 2048, "num_env_steps_sampled_throughput_per_sec": 163.7431947314473, "num_env_steps_trained_throughput_per_sec": 163.7431947314473, "timesteps_total": 14336, "num_steps_trained_this_iter": 2048, "agent_timesteps_total": 28672, "timers": {"training_iteration_time_ms": 13636.648, "sample_time_ms": 6848.393, "learn_time_ms": 6779.626, "learn_throughput": 302.082, "synch_weights_time_ms": 7.763}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "done": false, "episodes_total": 27, "training_iteration": 7, "trial_id": "e9e7e_00000", "date": "2024-04-12_21-54-02", "timestamp": 1712958842, "time_this_iter_s": 12.518601655960083, "time_total_s": 95.53058934211731, "pid": 4750, "hostname": "ip-172-31-8-71", "node_ip": "172.31.8.71", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "meltingpot", "env_config": {"substrate": "commons_harvest__collective", "roles": ["default", "default"], "scaled": 8}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "relu", "conv_filters": [[16, [3, 3], 1], [32, [7, 7], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 128, "lstm_use_prev_action": true, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 7, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function get_experiment_config.<locals>.<lambda> at 0x7fd7400e29e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 123, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0005], [100000000000.0, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [100000000000.0, 0.001]], "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 4, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}], "agent_1": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3}, "time_since_restore": 95.53058934211731, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 50.74999999999999, "ram_util_percent": 24.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.61093848049641, "cur_kl_coeff": 0.3, "cur_lr": 0.0004999998709759999, "total_loss": 1.9488983968039975, "policy_loss": 0.03819014070322737, "vf_loss": 1.9199375312309712, "vf_explained_var": -0.16295344494283198, "kl": 0.018986109331603985, "entropy": 1.492512483149767, "entropy_coeff": 0.00999999741952}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1230.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.090390806645154, "cur_kl_coeff": 0.6749999999999999, "cur_lr": 0.0004999998709759999, "total_loss": 2.453667387040332, "policy_loss": 0.0013005438260734082, "vf_loss": 2.45829528872855, "vf_explained_var": -0.37930173650383947, "kl": 0.012659203578175493, "entropy": 1.447340653836727, "entropy_coeff": 0.00999999741952}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1230.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "sampler_results": {"episode_reward_max": 55.0, "episode_reward_min": 16.0, "episode_reward_mean": 34.0, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 4.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 27.0, "agent_1": 31.0}, "policy_reward_mean": {"agent_0": 16.833333333333332, "agent_1": 17.166666666666668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0, 33.0, 26.0, 30.0, 33.0, 21.0, 44.0, 27.0, 29.0, 38.0, 55.0, 21.0, 17.0, 33.0, 52.0, 42.0, 33.0, 27.0, 26.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0, 14.0, 16.0, 23.0, 15.0, 16.0, 27.0, 9.0, 22.0, 25.0, 24.0, 6.0, 4.0, 14.0, 22.0, 27.0, 7.0, 4.0, 13.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0, 19.0, 10.0, 7.0, 18.0, 5.0, 17.0, 18.0, 7.0, 13.0, 31.0, 15.0, 13.0, 19.0, 30.0, 15.0, 26.0, 23.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3588308163906466, "mean_inference_ms": 7.44806845865572, "mean_action_processing_ms": 0.3690198480987108, "mean_env_wait_ms": 0.6034153761096712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008420944213867188, "ViewRequirementAgentConnector_ms": 0.27934948603312176}}, "episode_reward_max": 55.0, "episode_reward_min": 16.0, "episode_reward_mean": 34.0, "episode_len_mean": 500.0, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 4.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 27.0, "agent_1": 31.0}, "policy_reward_mean": {"agent_0": 16.833333333333332, "agent_1": 17.166666666666668}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0, 33.0, 26.0, 30.0, 33.0, 21.0, 44.0, 27.0, 29.0, 38.0, 55.0, 21.0, 17.0, 33.0, 52.0, 42.0, 33.0, 27.0, 26.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0, 14.0, 16.0, 23.0, 15.0, 16.0, 27.0, 9.0, 22.0, 25.0, 24.0, 6.0, 4.0, 14.0, 22.0, 27.0, 7.0, 4.0, 13.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0, 19.0, 10.0, 7.0, 18.0, 5.0, 17.0, 18.0, 7.0, 13.0, 31.0, 15.0, 13.0, 19.0, 30.0, 15.0, 26.0, 23.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3588308163906466, "mean_inference_ms": 7.44806845865572, "mean_action_processing_ms": 0.3690198480987108, "mean_env_wait_ms": 0.6034153761096712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008420944213867188, "ViewRequirementAgentConnector_ms": 0.27934948603312176}, "num_healthy_workers": 3, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_env_steps_sampled_this_iter": 2048, "num_env_steps_trained_this_iter": 2048, "num_env_steps_sampled_throughput_per_sec": 176.31040456875255, "num_env_steps_trained_throughput_per_sec": 176.31040456875255, "timesteps_total": 16384, "num_steps_trained_this_iter": 2048, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 13384.047, "sample_time_ms": 6825.279, "learn_time_ms": 6550.196, "learn_throughput": 312.662, "synch_weights_time_ms": 7.716}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "done": false, "episodes_total": 30, "training_iteration": 8, "trial_id": "e9e7e_00000", "date": "2024-04-12_21-54-14", "timestamp": 1712958854, "time_this_iter_s": 11.627237319946289, "time_total_s": 107.1578266620636, "pid": 4750, "hostname": "ip-172-31-8-71", "node_ip": "172.31.8.71", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "meltingpot", "env_config": {"substrate": "commons_harvest__collective", "roles": ["default", "default"], "scaled": 8}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "relu", "conv_filters": [[16, [3, 3], 1], [32, [7, 7], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 128, "lstm_use_prev_action": true, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 7, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function get_experiment_config.<locals>.<lambda> at 0x7fd7400e37f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 123, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0005], [100000000000.0, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [100000000000.0, 0.001]], "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 4, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}], "agent_1": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3}, "time_since_restore": 107.1578266620636, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 53.91875, "ram_util_percent": 24.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.628461877037495, "cur_kl_coeff": 0.3, "cur_lr": 0.000499999852544, "total_loss": 3.1401953644612255, "policy_loss": -0.010229162033647298, "vf_loss": 3.157425672867719, "vf_explained_var": 0.0791103720664978, "kl": 0.023154067554680618, "entropy": 1.394734537601471, "entropy_coeff": 0.00999999705088}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 84.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.702085884178388, "cur_kl_coeff": 0.6749999999999998, "cur_lr": 0.000499999852544, "total_loss": 1.6428534655859146, "policy_loss": -0.021537302859017955, "vf_loss": 1.6708746226778364, "vf_explained_var": -0.5114020533421461, "kl": 0.011984124422407757, "entropy": 1.457313730436213, "entropy_coeff": 0.00999999705088}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 84.5}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "sampler_results": {"episode_reward_max": 55.0, "episode_reward_min": 16.0, "episode_reward_mean": 35.111111111111114, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 4.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 28.0, "agent_1": 31.0}, "policy_reward_mean": {"agent_0": 17.333333333333332, "agent_1": 17.77777777777778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0, 33.0, 26.0, 30.0, 33.0, 21.0, 44.0, 27.0, 29.0, 38.0, 55.0, 21.0, 17.0, 33.0, 52.0, 42.0, 33.0, 27.0, 26.0, 32.0, 33.0, 52.0, 43.0, 52.0, 32.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0, 14.0, 16.0, 23.0, 15.0, 16.0, 27.0, 9.0, 22.0, 25.0, 24.0, 6.0, 4.0, 14.0, 22.0, 27.0, 7.0, 4.0, 13.0, 6.0, 18.0, 25.0, 28.0, 21.0, 21.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0, 19.0, 10.0, 7.0, 18.0, 5.0, 17.0, 18.0, 7.0, 13.0, 31.0, 15.0, 13.0, 19.0, 30.0, 15.0, 26.0, 23.0, 13.0, 26.0, 15.0, 27.0, 15.0, 31.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3474510581347552, "mean_inference_ms": 7.377526957416857, "mean_action_processing_ms": 0.36505045000300956, "mean_env_wait_ms": 0.5910522584905858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00852611329820421, "ViewRequirementAgentConnector_ms": 0.2836998966005113}}, "episode_reward_max": 55.0, "episode_reward_min": 16.0, "episode_reward_mean": 35.111111111111114, "episode_len_mean": 500.0, "episodes_this_iter": 6, "policy_reward_min": {"agent_0": 4.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 28.0, "agent_1": 31.0}, "policy_reward_mean": {"agent_0": 17.333333333333332, "agent_1": 17.77777777777778}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0, 33.0, 26.0, 30.0, 33.0, 21.0, 44.0, 27.0, 29.0, 38.0, 55.0, 21.0, 17.0, 33.0, 52.0, 42.0, 33.0, 27.0, 26.0, 32.0, 33.0, 52.0, 43.0, 52.0, 32.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0, 14.0, 16.0, 23.0, 15.0, 16.0, 27.0, 9.0, 22.0, 25.0, 24.0, 6.0, 4.0, 14.0, 22.0, 27.0, 7.0, 4.0, 13.0, 6.0, 18.0, 25.0, 28.0, 21.0, 21.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0, 19.0, 10.0, 7.0, 18.0, 5.0, 17.0, 18.0, 7.0, 13.0, 31.0, 15.0, 13.0, 19.0, 30.0, 15.0, 26.0, 23.0, 13.0, 26.0, 15.0, 27.0, 15.0, 31.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3474510581347552, "mean_inference_ms": 7.377526957416857, "mean_action_processing_ms": 0.36505045000300956, "mean_env_wait_ms": 0.5910522584905858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.00852611329820421, "ViewRequirementAgentConnector_ms": 0.2836998966005113}, "num_healthy_workers": 3, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_env_steps_sampled_this_iter": 2048, "num_env_steps_trained_this_iter": 2048, "num_env_steps_sampled_throughput_per_sec": 173.45446737098737, "num_env_steps_trained_throughput_per_sec": 173.45446737098737, "timesteps_total": 18432, "num_steps_trained_this_iter": 2048, "agent_timesteps_total": 36864, "timers": {"training_iteration_time_ms": 13208.829, "sample_time_ms": 6839.493, "learn_time_ms": 6360.778, "learn_throughput": 321.973, "synch_weights_time_ms": 7.706}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "done": false, "episodes_total": 36, "training_iteration": 9, "trial_id": "e9e7e_00000", "date": "2024-04-12_21-54-26", "timestamp": 1712958866, "time_this_iter_s": 11.816883563995361, "time_total_s": 118.97471022605896, "pid": 4750, "hostname": "ip-172-31-8-71", "node_ip": "172.31.8.71", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "meltingpot", "env_config": {"substrate": "commons_harvest__collective", "roles": ["default", "default"], "scaled": 8}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "relu", "conv_filters": [[16, [3, 3], 1], [32, [7, 7], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 128, "lstm_use_prev_action": true, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 7, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function get_experiment_config.<locals>.<lambda> at 0x7fd7400e24d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 123, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0005], [100000000000.0, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [100000000000.0, 0.001]], "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 4, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}], "agent_1": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3}, "time_since_restore": 118.97471022605896, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 53.36470588235294, "ram_util_percent": 24.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"agent_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.388309624615836, "cur_kl_coeff": 0.4500000000000002, "cur_lr": 0.0004999998341120001, "total_loss": 2.8311886401381345, "policy_loss": 0.0012061168275335256, "vf_loss": 2.835148951761863, "vf_explained_var": -0.2629263320389916, "kl": 0.020788750292625845, "entropy": 1.4521379940650043, "entropy_coeff": 0.00999999668224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1565.5, "diff_num_grad_updates_vs_sampler_policy": 84.5}, "agent_1": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.140093534133015, "cur_kl_coeff": 0.6749999999999998, "cur_lr": 0.0004999998341120001, "total_loss": 2.032414576512597, "policy_loss": 0.0023283126380513695, "vf_loss": 2.037457650373964, "vf_explained_var": -0.6388744221014135, "kl": 0.010673612917718641, "entropy": 1.4576074782539816, "entropy_coeff": 0.00999999668224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1565.5, "diff_num_grad_updates_vs_sampler_policy": 84.5}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "sampler_results": {"episode_reward_max": 55.0, "episode_reward_min": 16.0, "episode_reward_mean": 35.43589743589744, "episode_len_mean": 500.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 4.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 37.0, "agent_1": 31.0}, "policy_reward_mean": {"agent_0": 17.46153846153846, "agent_1": 17.974358974358974}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0, 33.0, 26.0, 30.0, 33.0, 21.0, 44.0, 27.0, 29.0, 38.0, 55.0, 21.0, 17.0, 33.0, 52.0, 42.0, 33.0, 27.0, 26.0, 32.0, 33.0, 52.0, 43.0, 52.0, 32.0, 39.0, 32.0, 47.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0, 14.0, 16.0, 23.0, 15.0, 16.0, 27.0, 9.0, 22.0, 25.0, 24.0, 6.0, 4.0, 14.0, 22.0, 27.0, 7.0, 4.0, 13.0, 6.0, 18.0, 25.0, 28.0, 21.0, 21.0, 15.0, 5.0, 37.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0, 19.0, 10.0, 7.0, 18.0, 5.0, 17.0, 18.0, 7.0, 13.0, 31.0, 15.0, 13.0, 19.0, 30.0, 15.0, 26.0, 23.0, 13.0, 26.0, 15.0, 27.0, 15.0, 31.0, 11.0, 24.0, 27.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3425114190984972, "mean_inference_ms": 7.348247867481246, "mean_action_processing_ms": 0.3633733321153288, "mean_env_wait_ms": 0.5859998877284078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008583680177346254, "ViewRequirementAgentConnector_ms": 0.2851724624633789}}, "episode_reward_max": 55.0, "episode_reward_min": 16.0, "episode_reward_mean": 35.43589743589744, "episode_len_mean": 500.0, "episodes_this_iter": 3, "policy_reward_min": {"agent_0": 4.0, "agent_1": 4.0}, "policy_reward_max": {"agent_0": 37.0, "agent_1": 31.0}, "policy_reward_mean": {"agent_0": 17.46153846153846, "agent_1": 17.974358974358974}, "hist_stats": {"episode_reward": [35.0, 36.0, 40.0, 41.0, 36.0, 40.0, 29.0, 41.0, 36.0, 16.0, 45.0, 38.0, 33.0, 26.0, 30.0, 33.0, 21.0, 44.0, 27.0, 29.0, 38.0, 55.0, 21.0, 17.0, 33.0, 52.0, 42.0, 33.0, 27.0, 26.0, 32.0, 33.0, 52.0, 43.0, 52.0, 32.0, 39.0, 32.0, 47.0], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500], "policy_agent_0_reward": [18.0, 19.0, 22.0, 19.0, 19.0, 19.0, 14.0, 27.0, 13.0, 12.0, 20.0, 15.0, 14.0, 16.0, 23.0, 15.0, 16.0, 27.0, 9.0, 22.0, 25.0, 24.0, 6.0, 4.0, 14.0, 22.0, 27.0, 7.0, 4.0, 13.0, 6.0, 18.0, 25.0, 28.0, 21.0, 21.0, 15.0, 5.0, 37.0], "policy_agent_1_reward": [17.0, 17.0, 18.0, 22.0, 17.0, 21.0, 15.0, 14.0, 23.0, 4.0, 25.0, 23.0, 19.0, 10.0, 7.0, 18.0, 5.0, 17.0, 18.0, 7.0, 13.0, 31.0, 15.0, 13.0, 19.0, 30.0, 15.0, 26.0, 23.0, 13.0, 26.0, 15.0, 27.0, 15.0, 31.0, 11.0, 24.0, 27.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3425114190984972, "mean_inference_ms": 7.348247867481246, "mean_action_processing_ms": 0.3633733321153288, "mean_env_wait_ms": 0.5859998877284078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"StateBufferConnector_ms": 0.008583680177346254, "ViewRequirementAgentConnector_ms": 0.2851724624633789}, "num_healthy_workers": 3, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_env_steps_sampled_this_iter": 2048, "num_env_steps_trained_this_iter": 2048, "num_env_steps_sampled_throughput_per_sec": 178.1718231208677, "num_env_steps_trained_throughput_per_sec": 178.1718231208677, "timesteps_total": 20480, "num_steps_trained_this_iter": 2048, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 13037.394, "sample_time_ms": 6815.771, "learn_time_ms": 6213.081, "learn_throughput": 329.627, "synch_weights_time_ms": 7.683}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "done": true, "episodes_total": 39, "training_iteration": 10, "trial_id": "e9e7e_00000", "date": "2024-04-12_21-54-37", "timestamp": 1712958877, "time_this_iter_s": 11.505576133728027, "time_total_s": 130.480286359787, "pid": 4750, "hostname": "ip-172-31-8-71", "node_ip": "172.31.8.71", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0.0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "meltingpot", "env_config": {"substrate": "commons_harvest__collective", "roles": ["default", "default"], "scaled": 8}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": null, "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0005, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 2048, "model": {"_disable_preprocessor_api": true, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "relu", "conv_filters": [[16, [3, 3], 1], [32, [7, 7], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": true, "max_seq_len": 20, "lstm_cell_size": 128, "lstm_use_prev_action": true, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 7, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function get_experiment_config.<locals>.<lambda> at 0x7fd7400e0d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "INFO", "log_sys_usage": true, "fake_sampler": false, "seed": 123, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": true, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": [[0, 0.0005], [100000000000.0, 5e-05]], "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": [[0, 0.01], [100000000000.0, 0.001]], "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "num_cpus": 4, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"agent_0": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}], "agent_1": [null, "Dict('COLLECTIVE_REWARD': Box(-inf, inf, (), float64), 'RGB': Box(0, 255, (7, 7, 3), uint8))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 3}, "time_since_restore": 130.480286359787, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 51.75294117647059, "ram_util_percent": 24.6}}
